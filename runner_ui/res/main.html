<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ADB 설정</title>
  <link href="lib/bootstrap.min.css" rel="stylesheet">
  <link href="main.css" rel="stylesheet">
  <script src="lib/jquery-3.7.1.min.js" ></script>
  <script>
let bridge = null
//$(document).ready(async function () {
async function connect_agw() {
    $('#adb_device').val('Trying to connect...')
    const device_id = await bridge.connect_agw()
    $('#adb_device').val(device_id)

    if (device_id) {
        await connect_ble()
    }
}
async function connect_ble() {
    info = await bridge.get_app_info()
    $('#agw_app').val(JSON.stringify(info, null, 2))

    resp = await bridge.connect_ble()
    $('#camera_device').val(JSON.stringify(resp, null, 2))
}
window.addEventListener('pywebviewready', () => {
    bridge = window.pywebview.api
    console.log("pywebview ready");
    connect_agw();
});

  </script>
</head>
<body>
  <h2>Android Gateway</h2>
    <div class="d-flex align-items-center gap-2 mb-3">
        <label for="adb_device" class="form-label mb-0">Android:</label>
        <input type="text" id="adb_device" class="form-control" placeholder="Device Not Found" readonly>
        <button class="btn btn-primary" onclick="connect_agw()">Connect</button>
    </div>
    <div class="d-flex align-items-center gap-2 mb-3">
        <label for="agw_app" class="form-label mb-0">App:</label>
        <textarea id="agw_app" class="form-control" readonly></textarea>
    </div>
    <div class="d-flex align-items-center gap-2 mb-3">
        <label for="camera_device" class="form-label mb-0">Camera:</label>
        <textarea id="camera_device" class="form-control" readonly></textarea>
        <button class="btn btn-primary" onclick="connect_ble()">Connect</button>
    </div>

  <textarea class="form-control" id="output" readonly></textarea>
</body>
</html>
