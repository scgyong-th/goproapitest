import camera
import pytest
import time

@pytest.mark.parametrize("settingId, name, values", [
    (0x02, 'Video Resolution', [  #  0x02 = 2
        (1, '4K'),
        (4, '2.7K'),
        (9, '1080'),
        # (12, '720'),
        # (35, '5.3K 21:9'),
        # (36, '4K 21:9'),
        # (37, '4K 1:1'),
        # (38, '900'),
        # (100, '5.3K'),
        # (107, '5.3K 8:7 V2'),
        # (108, '4K 8:7 V2'),
        # (109, '4K 9:16 V2'),
        # (110, '1080 9:16 V2'),
        # (111, '2.7K 4:3 V2'),
        # (112, '4K 4:3 V2'),
        # (113, '5.3K 4:3 V2'),
    ]),
    (0x03, 'Frames Per Second', [  #  0x03 = 3
        (0, '240.0'),
        (1, '120.0'),
        # (2, '100.0'),
        # (5, '60.0'),
        # (6, '50.0'),
        # (8, '30.0'),
        # (9, '25.0'),
        # (10, '24.0'),
        # (13, '200.0'),
        # (15, '400.0'),
        # (16, '360.0'),
        # (17, '300.0'),
    ]),
    # (0x05, 'Video Timelapse Rate', [  #  0x05 = 5
    #     (0, '0.5 Seconds'),
    #     (1, '1 Second'),
    #     (2, '2 Seconds'),
    #     (3, '5 Seconds'),
    #     (4, '10 Seconds'),
    #     (5, '30 Seconds'),
    #     (6, '60 Seconds'),
    #     (7, '2 Minutes'),
    #     (8, '5 Minutes'),
    #     (9, '30 Minutes'),
    #     (10, '60 Minutes'),
    #     (11, '3 Seconds'),
    # ]),
    # (0x1E, 'Photo Timelapse Rate', [  #  0x1E = 30
    #     (11, '3 Seconds'),
    #     (100, '60 Minutes'),
    #     (101, '30 Minutes'),
    #     (102, '5 Minutes'),
    #     (103, '2 Minutes'),
    #     (104, '60 Seconds'),
    #     (105, '30 Seconds'),
    #     (106, '10 Seconds'),
    #     (107, '5 Seconds'),
    #     (108, '2 Seconds'),
    #     (109, '1 Second'),
    #     (110, '0.5 Seconds'),
    # ]),
    # (0x20, 'Nightlapse Rate', [  #  0x20 = 32
    #     (4, '4 Seconds'),
    #     (5, '5 Seconds'),
    #     (10, '10 Seconds'),
    #     (15, '15 Seconds'),
    #     (20, '20 Seconds'),
    #     (30, '30 Seconds'),
    #     (100, '60 Seconds'),
    #     (120, '2 Minutes'),
    #     (300, '5 Minutes'),
    #     (1800, '30 Minutes'),
    #     (3600, '60 Minutes'),
    #     (3601, 'Auto'),
    # ]),
    # (0x2B, 'Webcam Digital Lenses', [  #  0x2B = 43
    #     (0, 'Wide'),
    #     (2, 'Narrow'),
    #     (3, 'Superview'),
    #     (4, 'Linear'),
    # ]),
    # (0x3B, 'Auto Power Down', [  #  0x3B = 59
    #     (0, 'Never'),
    #     (1, '1 Min'),
    #     (4, '5 Min'),
    #     (6, '15 Min'),
    #     (7, '30 Min'),
    # ]),
    (0x53, 'GPS', [  #  0x53 = 83
        (0, 'Off'),
        (1, 'On'),
    ]),
    (0x5B, 'LED', [  #  0x5B = 91
        (3, 'All On'),
        (100, 'Back Only'),
    ]),
    # (0x6C, 'Video Aspect Ratio', [  #  0x6C = 108
    #     (0, '4:3'),
    #     (1, '16:9'),
    #     (3, '8:7'),
    #     (4, '9:16'),
    #     (5, '21:9'),
    #     (6, '1:1'),
    # ]),
    # (0x79, 'Video Lens', [  #  0x79 = 121
    #     (0, 'Wide'),
    #     (2, 'Narrow'),
    #     (3, 'Superview'),
    #     (4, 'Linear'),
    #     (8, 'Linear + Horizon Leveling'),
    #     (9, 'HyperView'),
    #     (10, 'Linear + Horizon Lock'),
    #     (12, 'Ultra SuperView'),
    #     (13, 'Ultra Wide'),
    #     (14, 'Ultra Linear'),
    #     (104, 'Ultra HyperView'),
    # ]),
    # (0x7A, 'Photo Lens', [  #  0x7A = 122
    #     (0, 'Wide 12 MP'),
    #     (10, 'Linear 12 MP'),
    #     (27, 'Wide 23 MP'),
    #     (28, 'Linear 23 MP'),
    #     (31, 'Wide 27 MP'),
    #     (32, 'Linear 27 MP'),
    #     (38, '13MP Linear'),
    #     (39, '13MP Wide'),
    #     (40, '13MP Ultra Wide'),
    #     (41, 'Ultra Wide 12 MP'),
    #     (44, '13MP Ultra Linear'),
    # ]),
    # (0x7B, 'Time Lapse Digital Lenses', [  #  0x7B = 123
    #     (31, 'Wide 27 MP'),
    #     (32, 'Linear 27 MP'),
    # ]),
    # (0x7D, 'Photo Output', [  #  0x7D = 125
    #     (0, 'Standard'),
    #     (1, 'Raw'),
    #     (2, 'HDR'),
    #     (3, 'SuperPhoto'),
    # ]),
    # (0x80, 'Media Format', [  #  0x80 = 128
    #     (13, 'Time Lapse Video'),
    #     (20, 'Time Lapse Photo'),
    #     (21, 'Night Lapse Photo'),
    #     (26, 'Night Lapse Video'),
    # ]),
    # (0x86, 'Anti-Flicker', [  #  0x86 = 134
    #     (0, 'NTSC'),
    #     (1, 'PAL'),
    # ]),
    # (0x87, 'Hypersmooth', [  #  0x87 = 135
    #     (0, 'Off'),
    #     (1, 'Low'),
    #     (4, 'Auto Boost'),
    # ]),
    # (0x9C, 'Video Duration', [  #  0x9C = 156
    #     (1, '15 Seconds'),
    #     (2, '30 Seconds'),
    #     (3, '1 Minute'),
    #     (4, '5 Minutes'),
    #     (5, '15 Minutes'),
    #     (6, '30 Minutes'),
    #     (7, '1 Hour'),
    #     (8, '2 Hours'),
    #     (9, '3 Hours'),
    #     (10, '5 Seconds'),
    #     (100, 'No Limit'),
    # ]),
    # (0x9D, 'Multi Shot Duration', [  #  0x9D = 157
    #     (1, '15 Seconds'),
    #     (2, '30 Seconds'),
    #     (3, '1 Minute'),
    #     (4, '5 Minutes'),
    #     (5, '15 Minutes'),
    #     (6, '30 Minutes'),
    #     (7, '1 Hour'),
    #     (8, '2 Hours'),
    #     (9, '3 Hours'),
    #     (100, 'No Limit'),
    # ]),
    # (0xA7, 'HindSight', [  #  0xA7 = 167
    #     (2, '15 Seconds'),
    #     (3, '30 Seconds'),
    #     (4, 'Off'),
    # ]),
    # (0xAB, 'Photo Single Interval', [  #  0xAB = 171
    #     (0, 'Off'),
    #     (2, '0.5s'),
    #     (3, '1s'),
    #     (4, '2s'),
    #     (5, '5s'),
    #     (6, '10s'),
    #     (7, '30s'),
    #     (8, '60s'),
    #     (9, '120s'),
    #     (10, '3s'),
    # ]),
    # (0xAC, 'Photo Interval Duration', [  #  0xAC = 172
    #     (0, 'Off'),
    #     (1, '15 Seconds'),
    #     (2, '30 Seconds'),
    #     (3, '1 Minute'),
    #     (4, '5 Minutes'),
    #     (5, '15 Minutes'),
    #     (6, '30 Minutes'),
    #     (7, '1 Hour'),
    #     (8, '2 Hours'),
    #     (9, '3 Hours'),
    # ]),
    # (0xAF, 'Control Mode', [  #  0xAF = 175
    #     (0, 'Easy'),
    #     (1, 'Pro'),
    # ]),
    # (0xB0, 'Easy Mode Speed', [  #  0xB0 = 176
    #     (100, '8X Ultra Slo-Mo (V2)'),
    #     (101, '4X Super Slo-Mo (V2)'),
    #     (102, '2X Slo-Mo (V2)'),
    #     (103, '1X Speed (Low Light) (V2)'),
    #     (104, '8X Ultra Slo-Mo (50Hz) (V2)'),
    #     (105, '4X Super Slo-Mo (50Hz) (V2)'),
    #     (106, '2X Slo-Mo (50Hz) (V2)'),
    #     (107, '1X Speed (50Hz) (Low Light) (V2)'),
    #     (108, '8X Ultra Slo-Mo (Long. Batt.) (V2)'),
    #     (109, '4X Super Slo-Mo (Long. Batt.) (V2)'),
    #     (110, '2X Slo-Mo (Long. Batt.) (V2)'),
    #     (111, '1X Speed (Long. Batt.) (Low Light) (V2)'),
    #     (112, '8X Ultra Slo-Mo (50Hz) (Long. Batt.) (V2)'),
    #     (113, '4X Super Slo-Mo (50Hz) (Long. Batt.) (V2)'),
    #     (114, '2X Slo-Mo (50Hz) (Long. Batt.) (V2)'),
    #     (115, '1X Speed (50Hz) (Long. Batt.) (Low Light) (V2)'),
    #     (116, '2X Slo-Mo (4K) (V2)'),
    #     (117, '2X Slo-Mo (4K) (50Hz) (V2)'),
    #     (118, '1X Speed (Low Light) (V2) (Vertical)'),
    #     (119, '1X Speed (50Hz) (Low Light) (V2) (Vertical)'),
    #     (120, '2X Slo-Mo (V2) (Vertical)'),
    #     (121, '2X Slo-Mo (50Hz) (V2) (Vertical)'),
    #     (122, '1X Speed (Full Frame) (Low Light) (V2)'),
    #     (123, '1X Speed (50Hz) (Full Frame) (Low Light) (V2)'),
    #     (124, '2X Slo-Mo (Full Frame) (V2)'),
    #     (125, '2X Slo-Mo (50Hz) (Full Frame) (V2)'),
    #     (126, '1X Speed (4K) (Low Light) (V2)'),
    #     (127, '1X Speed (4K) (50Hz) (Low Light) (V2)'),
    #     (132, '2X Slo-Mo (Long. Batt.) (V2) (Vertical)'),
    #     (133, '2X Slo-Mo (50Hz) (Long. Batt.) (V2) (Vertical)'),
    #     (134, '1X Speed (Long. Batt.) (Low Light) (V2) (Vertical)'),
    #     (135, '1X Speed (50Hz) (Long. Batt.) (Low Light) (V2) (Vertical)'),
    #     (136, '1X Speed (4K) (Full Frame) (Low Light) (V2)'),
    #     (137, '1X Speed (4K) (50Hz) (Full Frame) (Low Light) (V2)'),
    #     (138, '1X Normal Speed (1:1) (30 Fps) (4K) (V2)'),
    #     (139, '1X Normal Speed (1:1) (25 Fps) (4K) (V2)'),
    #     (140, '2X Slo-Mo Speed (1:1) (4K) (60 Fps) (V2)'),
    #     (141, '2X Slo-Mo Speed (1:1) (4K) (50 Fps) (V2)'),
    #     (142, '1X Normal Speed (21:9) (30 Fps) (5.3K) (V2)'),
    #     (143, '1X Normal Speed (21:9) (25 Fps) (5.3K) (V2)'),
    #     (144, '2X Slo-Mo Speed (21:9) (5.3K) (60 Fps) (V2)'),
    #     (145, '2X Slo-Mo Speed (21:9) (5.3K) (50 Fps) (V2)'),
    #     (146, '1X Normal Speed (21:9) (30 Fps) (4K) (V2)'),
    #     (147, '1X Normal Speed (21:9) (25 Fps) (4K) (V2)'),
    #     (148, '2X Slo-Mo Speed (21:9) (4K) (60 Fps) (V2)'),
    #     (149, '2X Slo-Mo Speed (21:9) (4K) (50 Fps) (V2)'),
    #     (150, '120 4X Super Slo-Mo Speed (21:9) (4K) (V2)'),
    #     (151, '100 4X Super Slo-Mo Speed (21:9) (4K) (V2)'),
    #     (152, '1X Normal Speed (30 Fps) (4:3) (5.3K) (V2)'),
    #     (153, '1X Normal Speed (25 Fps) (4:3) (5.3K) (V2)'),
    #     (154, '1X Normal Speed (30 Fps) (4:3) (4K) (V2)'),
    #     (155, '1X Normal Speed (25 Fps) (4:3) (4K) (V2)'),
    #     (156, '2X Slo-Mo Speed (4:3) (4K) (60 Fps) (V2)'),
    #     (157, '2X Slo-Mo Speed (4:3) (4K) (50 Fps) (V2)'),
    #     (158, '120 4X Super Slo-Mo Speed (2.7K) (4:3) (V2)'),
    #     (159, '100 4X Super Slo-Mo Speed (2.7K) (4:3) (V2)'),
    # ]),
    # (0xB2, 'Wireless Band', [  #  0xB2 = 178
    #     (0, '2.4GHz'),
    #     (1, '5GHz'),
    # ]),
    # (0xB3, 'Star Trails Length', [  #  0xB3 = 179
    #     (1, 'Short'),
    #     (2, 'Long'),
    #     (3, 'Max'),
    # ]),
    # (0xB4, 'System Video Mode', [  #  0xB4 = 180
    #     (0, 'Highest Quality'),
    #     (111, 'Standard Quality'),
    #     (112, 'Basic Quality'),
    # ]),
    # (0xB6, 'Video Bit Rate', [  #  0xB6 = 182
    #     (0, 'Standard'),
    #     (1, 'High'),
    # ]),
    # (0xB7, 'Bit Depth', [  #  0xB7 = 183
    #     (0, '8-Bit'),
    #     (2, '10-Bit'),
    # ]),
    # (0xB8, 'Profiles', [  #  0xB8 = 184
    #     (0, 'Standard'),
    #     (1, 'HDR'),
    #     (2, 'Log'),
    #     (101, 'HLG HDR'),
    # ]),
    # (0xBA, 'Video Easy Mode', [  #  0xBA = 186
    #     (3, 'Standard Video'),
    #     (4, 'HDR Video'),
    # ]),
    # (0xBB, 'Lapse Mode', [  #  0xBB = 187
    #     (0, 'TimeWarp'),
    #     (1, 'Star Trails'),
    #     (2, 'Light Painting'),
    #     (3, 'Vehicle Lights'),
    #     (8, 'Time Lapse Video'),
    #     (9, 'Night Lapse Video'),
    # ]),
    # (0xBD, 'Max Lens Mod', [  #  0xBD = 189
    #     (2, 'Max Lens 2.0'),
    #     (3, 'Max Lens 2.5'),
    #     (4, 'Macro'),
    #     (5, 'Anamorphic'),
    #     (6, 'ND 4'),
    #     (7, 'ND 8'),
    #     (8, 'ND 16'),
    #     (9, 'ND 32'),
    #     (10, 'Standard Lens'),
    #     (100, 'Auto Detect'),
    # ]),
    # (0xBF, 'Easy Night Photo', [  #  0xBF = 191
    #     (0, 'Super Photo'),
    #     (1, 'Night Photo'),
    #     (2, 'Burst'),
    # ]),
    # (0xC0, 'Multi Shot Aspect Ratio', [  #  0xC0 = 192
    #     (0, '4:3'),
    #     (1, '16:9'),
    #     (3, '8:7'),
    #     (4, '9:16'),
    # ]),
    # (0xC1, 'Framing', [  #  0xC1 = 193
    #     (100, 'Traditional 4:3 v2'),
    #     (101, 'Widescreen 16:9 v2'),
    #     (103, 'Full Frame 8:7 v2'),
    #     (104, 'Vertical 9:16 v2'),
    #     (105, 'Ultra Widescreen 21:9 v2'),
    #     (106, 'Full Frame 1:1 v2'),
    # ]),
    # (0xD8, 'Camera Volume', [  #  0xD8 = 216
    #     (70, 'Low'),
    #     (85, 'Medium'),
    #     (100, 'High'),
    # ]),
    # (0xDB, 'Setup Screen Saver', [  #  0xDB = 219
    #     (1, '1 Min'),
    #     (2, '2 Min'),
    #     (3, '3 Min'),
    #     (4, '5 Min'),
    # ]),
    # (0xDF, 'Setup Language', [  #  0xDF = 223
    #     (0, 'English - US'),
    #     (1, 'English - UK'),
    #     (2, 'English - AUS'),
    #     (3, 'German'),
    #     (4, 'French'),
    #     (5, 'Italian'),
    #     (6, 'Spanish'),
    #     (7, 'Spanish - NA'),
    #     (8, 'Chinese'),
    #     (9, 'Japanese'),
    #     (10, 'Korean'),
    #     (11, 'Portuguese'),
    #     (12, 'Russian'),
    #     (13, 'English - IND'),
    #     (14, 'Swedish'),
    # ]),
    # (0xE3, 'Photo Mode', [  #  0xE3 = 227
    #     (0, 'SuperPhoto'),
    #     (1, 'Night Photo'),
    #     (2, 'Burst'),
    # ]),
    # (0xE8, 'Video Framing', [  #  0xE8 = 232
    #     (0, '4:3'),
    #     (1, '16:9'),
    #     (3, '8:7'),
    #     (4, '9:16'),
    #     (5, '21:9'),
    #     (6, '1:1'),
    # ]),
    # (0xE9, 'Multi Shot Framing', [  #  0xE9 = 233
    #     (0, '4:3'),
    #     (1, '16:9'),
    #     (3, '8:7'),
    #     (4, '9:16'),
    # ]),
    # (0xEA, 'Frame Rate', [  #  0xEA = 234
    #     (0, '240.0'),
    #     (1, '120.0'),
    #     (2, '100.0'),
    #     (5, '60.0'),
    #     (6, '50.0'),
    #     (8, '30.0'),
    #     (9, '25.0'),
    #     (10, '24.0'),
    #     (13, '200.0'),
    #     (15, '400.0'),
    #     (16, '360.0'),
    #     (17, '300.0'),
    # ]),
])
def test_set_setting(cfg, settingId, name, values):
    print(f'Setting 0x{settingId:02x}({settingId}) # {name}')
    req = camera.GetSettingValues(settingId)
    msg = camera.proceed_agw_test(req, cfg)

    assert settingId in msg['tlv']
    originalValue = msg['tlv'][settingId]
    print(f'Original value = {originalValue}')

    for value, name in values:
        set_setting(cfg, settingId, value, name)
    
    set_setting(cfg, settingId, originalValue, 'Original')

def set_setting(cfg, settingId, value, name):
    print(f'Setting to {value} # ({name})')
    req = camera.SetSettingValue(settingId, value)
    msg = camera.proceed_agw_test(req, cfg)

    time.sleep(0.5)
    req = camera.GetSettingValues(settingId)
    msg = camera.proceed_agw_test(req, cfg)
    value_from_camera = msg['tlv'][settingId]

    assert value == value_from_camera
